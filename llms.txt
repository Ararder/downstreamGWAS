# downstreamGWAS

downstreamGWAS is a companion package to
[tidyGWAS](http://arvidharder.com/downstreamGWAS/www.arvidharder.com/tidyGWAS).
downstreamGWAS provides functions to run standardize genetic pipelines
using summary statistics as input. External software is packaged through
docker files available at
[dockerhub](https://hub.docker.com/repository/docker/arvhar/genetics/general).

In addition to this, reference files needed for pipelines bundled into
the containers are available through zenodo. Link TBD.

DownstreamGWAS utilises three factors to make genetic analysis much
simplified: 1. Harmonized GWAS format through
[tidyGWAS](http://arvidharder.com/downstreamGWAS/www.arvidharder.com/tidyGWAS)
2. External software packaged into docker images, that can be run on
HPCs with singularity/apptainer 3. References files collected and
available for download, with harmonized filepaths

## Installation

``` r
remotes::install_github("ararder/downstreamGWAS")
devtools::install_github("ararder/downstreamGWAS")
```

downstreamGWAS requires a filepaths.yml file to be created, and for you
to add some information to it.

\`\`\`{r} dir_to_store_yaml_in =
“/nas/depts/007/sullilab/shared/gwas_sumstats”
setup_filepaths_yml(dir_to_store_yaml_in) \# get script to download
singularity images sif_script()

\`\`\`

## Download singularity images

# Package index

## All functions

- [`check_setup()`](http://arvidharder.com/downstreamGWAS/reference/check_setup.md)
  : Check that the configuration file has been correctly set up

- [`dsg_method_output_dir()`](http://arvidharder.com/downstreamGWAS/reference/dsg_method_output_dir.md)
  : Resolve downstreamGWAS pipeline output directory

- [`effective_n()`](http://arvidharder.com/downstreamGWAS/reference/effective_n.md)
  : Calculate effective N

- [`format_coloc()`](http://arvidharder.com/downstreamGWAS/reference/format_coloc.md)
  :

  Format the output of
  [`coloc::coloc.abf()`](https://rdrr.io/pkg/coloc/man/coloc.abf.html)

- [`get_system_paths()`](http://arvidharder.com/downstreamGWAS/reference/get_system_paths.md)
  : Read downstreamGWAS filepaths from yaml file downstreamGWAS manages
  external filepaths through two files:

- [`liability_scale_h2()`](http://arvidharder.com/downstreamGWAS/reference/liability_scale_h2.md)
  : Convert an estiamte of observed-scale heritability to liability
  scale heritability

- [`ls_sumstats()`](http://arvidharder.com/downstreamGWAS/reference/ls_sumstats.md)
  : List the available sumstats

- [`mr_on_tidyGWAS()`](http://arvidharder.com/downstreamGWAS/reference/mr_on_tidyGWAS.md)
  : Run two-sample mendelian randomisation using the TwoSampleMR package

- [`pipeline_clumping()`](http://arvidharder.com/downstreamGWAS/reference/pipeline_clumping.md)
  : Pipeline clumping

- [`pipeline_sbayesrc()`](http://arvidharder.com/downstreamGWAS/reference/pipeline_sbayesrc.md)
  : Pipeline SBayesRC

- [`pipeline_sbayess()`](http://arvidharder.com/downstreamGWAS/reference/pipeline_sbayess.md)
  : Pipeline SBayesS

- [`ranges_to_bed()`](http://arvidharder.com/downstreamGWAS/reference/ranges_to_bed.md)
  : Convert the output of plink clumping ranges to a flat file

- [`read_gwas()`](http://arvidharder.com/downstreamGWAS/reference/read_gwas.md)
  : Read in a tidyGWAS formatted summary statistics file

- [`read_ldsc_h2()`](http://arvidharder.com/downstreamGWAS/reference/read_ldsc_h2.md)
  : read the output of LDSC –h2

- [`run_clumping()`](http://arvidharder.com/downstreamGWAS/reference/run_clumping.md)
  : Run a clumping pipeline on a tidyGWAS sumstats

- [`run_coloc()`](http://arvidharder.com/downstreamGWAS/reference/run_coloc.md)
  : Run coloc::coloc.abf on tidyGWAS data

- [`run_mbat_combo()`](http://arvidharder.com/downstreamGWAS/reference/run_mbat_combo.md)
  : run mBAT-combo gene-test in GCTB

- [`run_sbayesrc()`](http://arvidharder.com/downstreamGWAS/reference/run_sbayesrc.md)
  : Run sbayerc with tidyGWAS structure

- [`run_sbayess()`](http://arvidharder.com/downstreamGWAS/reference/run_sbayess.md)
  : Run Sbayes-S with tidyGWAS structure

- [`run_sbayess_req()`](http://arvidharder.com/downstreamGWAS/reference/run_sbayess_req.md)
  : Check if required files exist for Sbayes-S

- [`schedule_slurm()`](http://arvidharder.com/downstreamGWAS/reference/schedule_slurm.md)
  : Construct a SLURM schedule object

- [`setup()`](http://arvidharder.com/downstreamGWAS/reference/setup.md)
  : Setup required filepaths for downstreamGWAS

- [`setup_dsg()`](http://arvidharder.com/downstreamGWAS/reference/setup_dsg.md)
  : Setup downstreamGWAS config

- [`slurm_header()`](http://arvidharder.com/downstreamGWAS/reference/slurm_header.md)
  : Construct a slurm header

- [`tidyGWAS_paths()`](http://arvidharder.com/downstreamGWAS/reference/tidyGWAS_paths.md)
  : Create the folder structure and filepaths for downstreamGWAS
  directory

- [`to_clumping()`](http://arvidharder.com/downstreamGWAS/reference/to_clumping.md)
  : Prepare tidyGWAS sumstats for PLINK clumping

- [`to_ldsc()`](http://arvidharder.com/downstreamGWAS/reference/to_ldsc.md)
  : Export tidyGWAS format to LDSC format

- [`to_ma()`](http://arvidharder.com/downstreamGWAS/reference/to_ma.md)
  : Convert tidyGWAS to COJO .ma format

- [`to_plink_clumping()`](http://arvidharder.com/downstreamGWAS/reference/to_plink_clumping.md)
  : Convert tidyGWAS hivestyle partitioning to compatible format for
  plink clumping

- [`with_container()`](http://arvidharder.com/downstreamGWAS/reference/with_container.md)
  : Run arbitrary code inside a container

# Articles

### All vignettes

- [downstreamGWAS](http://arvidharder.com/downstreamGWAS/articles/downstreamGWAS.md):
- [meta-analysis](http://arvidharder.com/downstreamGWAS/articles/meta-analysis.md):
- [multi-file
  datasets](http://arvidharder.com/downstreamGWAS/articles/multi-file-datasets.md):
